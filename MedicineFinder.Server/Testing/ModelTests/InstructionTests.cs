using MedicineFinder.Server.Models;
using NUnit.Framework;

namespace MedicineFinder.Server.Testing.ModelTests
{
    /// <summary>
    /// Класс, содержащий модульные тесты для класса
    /// <see cref="Instruction"/>.
    /// </summary>
    [TestFixture]
    public class InstructionTests
    {
        /// <summary>
        /// Тестовый объект <see cref="Instruction"/>.
        /// </summary>
        private readonly Instruction _testInstruction = new()
        {
            StorageCondition =
                        "<P>Препарат следует хранить в защищенном от света, недоступном для детей месте при температуре не выше 25&deg;С. ",
            StorageLife =
                        "Срок годности - 3 года. Не использовать препарат после истечения срока годности, указанного на упаковке.</P><P>После вскрытия флакона или тубы препарат следует использовать в течение 6 недель.</P>",
            Companies =
                    [
                        new CompanyDetailed
                        {
                            Address =
                                "<P>115162 Москва,<BR />ул. Шаболовка, д. 31, стр. 5<BR />Тел.: +7 (495) 510-28-79<BR />E-mail: office.ru@bausch.com<BR />https://www.bausch.ru</P>"
                        }
                    ],
            PharmacologicalEffect =
                        "<P>Производное хинолиновой кислоты, офлоксацин, является ингибитором гиразы с бактерицидным действием.</P><P><I><B>Предельные значения минимальной подавляющей концентрации</B></I></P><P>В упомянутом ниже исследовании резистентности офлоксацин оценивался с использованием обычно применяемых серий разведений. В отношении восприимчивых и устойчивых микроорганизмов была установлена следующая минимальная подавляющая концентрация. </P><P><I>Предельные значения минимальной подавляющей концентрации EUCAST (Европейский комитет по испытаниям чувствительности к антимикробным препаратам)</I></P><TABLE width=\"100%\" border=\"1\"><TR><TD><B>Возбудитель</B></TD><TD><B>Чувствительный</B></TD><TD><B>Устойчивый</B></TD></TR><TR><TD><I>Enterobacteriaceae</I></TD><TD>&le;0.5 мг/л</TD><TD>&gt;1 мг/л</TD></TR><TR><TD><I>Staphylococcus spp.</I></TD><TD>&le;1 мг/л</TD><TD>&gt;1 мг/л</TD></TR><TR><TD><I>Streptococcus pneumoniae</I></TD><TD>&le;0.125 мг/л</TD><TD>&gt;4 мг/л</TD></TR><TR><TD><I>Haemophilus influenzae</I></TD><TD>&le;0.5 мг/л</TD><TD>&gt;0.5 мг/л</TD></TR><TR><TD><I>Moraxella catarrhalis</I></TD><TD>&le;0.5 мг/л</TD><TD>&gt;0.5 мг/л</TD></TR><TR><TD><I>Neisseria gonorrhoeae</I></TD><TD>&le;0.12 мг/л</TD><TD>&gt;0.25 мг/л</TD></TR><TR><TD>не видоспецифичные предельные значения минимальной подавляющей концентрации*</TD><TD>&le;0.5 мг/л</TD><TD>&gt;1 мг/л</TD></TR></TABLE><P class=\"F7\">* Основано преимущественно на фармакокинетике в сыворотке крови.</P><P><I><B>Антибактериальный спектр</B></I></P><P>Спектр антибактериального действия офлоксацина включает облигатные анаэробы, факультативные анаэробы, анаэробы и другие микроорганизмы, например, такие как хламидии. Распространенность приобретенной устойчивости может варьировать у отдельных видов географически и со временем, поэтому желательно иметь местную информацию о резистентности, особенно при лечении тяжелых инфекций. Если местная распространенность резистентных микроорганизмов такова, что эффективность офлоксацина сомнительна, при необходимости, следует обратиться за советом к специалисту. Особенно в случае тяжелых инфекций или отсутствия микробиологической эффективности должна быть проведена диагностика с выявлением патологического микроорганизма. Вероятно возникновение перекрестной устойчивости офлоксацина с другими фторхинолонами.</P><P>Данные по резистентности, представленные в следующей таблице, основываются преимущественно на текущих результатах исследования распространенности резистентности среди 1391 бактериального изолята, выделенных у пациентов с глазными инфекциями (преимущественно в мазках) в 31 клиническом центре Германии. Данные основаны на упомянутых выше предельных значениях минимальной подавляющей концентрации при системном применении. При местном применении офлоксацина на глазах, в передней камере глаза, как правило, достигаются более высокие концентрации, чем при системном способе применения. Таким образом, клиническая эффективность по одобренным показаниям к применению может также достигаться в отношении таких агентов, как В. Enterococcus spp., который в условиях in vitro был определен, как устойчивый микроорганизм.</P><P><U>Обычно восприимчивые виды</U></P><P><I>Аэробные грамположительные микроорганизмы:</I> Bacillus spp., Staphylococcus aureus (метициллин-чувствительный).</P><P><I>Аэробные грамотрицательные микроорганизмы:</I> Acinetobacter baumannii, Acinetobacter Iwoffi, Enterobacter cloacae, Escherichia coli, Haemophilus influenzae, Haemophilus parainfluenzae, Klebsiella oxytoca, Klebsiella pneumoniae, Moraxella catarrhalis, Proteus mirabilis, Serratia marcescens.</P><P><U>Виды, для которых приобретенная устойчивость может быть проблемой во время лечения</U></P><P><I>Аэробные грамположительные микроорганизмы: </I>Corynebacterium spp., Enterococcus faecalis, Staphylococcus aureus (метициллин-чувствительный)<SUP>+</SUP>, Staphylococcus epidermidis<SUP>$ </SUP>, Streptococcus pneumoniae<SUP>$</SUP>, Streptococcaceae (кроме Streptococcus pneumoniae)<SUP>$</SUP>.</P><P><I>Аэробные грамотрицательные микроорганизмы:</I> Pseudomonas aeruginosa, Stenotrophomonas maltophilia.</P><P><U>Виды с природной устойчивостью</U></P><P><I>Аэробные грамположительные микроорганизмы:</I> Enterococcus spp.</P><P class=\"F7\"><SUP>$ </SUP>Считается, что естественная восприимчивость большинства бактериальных изолятов к данному антибиотику является промежуточной. Однако, в слезной пленке наблюдаются концентрации не менее 4 мг/л в течение 4 ч после однократного применения, что надежно уничтожает 100% изолятов.</P><P class=\"F7\"><SUP>+</SUP>По крайней мере, в одном участке уровень устойчивости составляет более 50%. </P>",
            Pharmacokinetics =
                        "<P>Эффективность зависит главным образом от соотношения C<SUB>max </SUB>в ткани и минимальной подавляющей концентрации (МПК) для патогена.</P><P>Доклинические исследования показали, что офлоксацин, применяемый местно, обнаруживался в роговице, конъюнктиве, глазной мышце, склере, радужной оболочке, цилиарном теле и передней камере. Многократные применения обеспечивали достижение терапевтических концентраций и в стекловидном теле.</P><P>После 5-кратного введения препарата <B>Флоксал, капли глазные</B>, с пятиминутными интервалами, концентрации офлоксацина во внутриглазной жидкости у пациента колебались от 1.2 до 1.7 мкг/мл в течение 60-120 минут после применения дозы. В течение 3 ч значение снижалось до 0.8 мкг/мл. В зависимости от применения, концентрации действующего вещества во внутриглазной жидкости снижались почти до нуля в течение 5-6 ч после приема дозы. На основании результатов доклинических исследований предполагается, что концентрации действующего вещества в других тканях глаза выше, чем во внутриглазной жидкости. Поскольку офлоксацин способен поглощаться тканями, содержащими меланин, предполагается его замедленное выведение из таких тканей. T<SUB>1/2</SUB> из сыворотки крови системно поглощенного офлоксацина составляет 3.5-6.7 ч. </P><P>После однократного применения препарата <B>Флоксал, мазь глазная</B>, полоски мази длиной около 1 см (эквивалентно 0.12 мг офлоксацина), максимальные концентрации 9.72 мкг/г в роговице и 1.61 мкг/г в склере достигались через 5 минут после применения дозы. После этого концентрации медленно снижались. Измеренные максимальные концентрации в водянистой жидкости и роговице составили 0.69 мкг/г и 4.87 мкг/г через 1 ч после применения дозы.</P>",
            DosageRegimen =
                        "<P>Препарат в форме <B>глазных капель</B> назначают по 1 капле в конъюнктивальный мешок больного глаза 2-4 раза/сут. Не рекомендуется применять препарат более 14 дней.</P><P>При необходимости одновременного применения более одного препарата следует соблюдать минимальный 15-минутный интервал между инстилляциями.</P><P>Препарат в форме <B>глазной мази, </B>если нет других рекомендаций от врача, применяют следующим образом: 1 см полоски мази (эквивалентно 0.12 мг офлоксацина) закладывается за нижнее веко больного глаза 3 раза/сут; в случае <I>хламидийной инфекции - </I>5 раз/сут. Не рекомендуется применять препарат более 14 дней.</P><P>При одновременном применении более одного препарата необходимо соблюдать минимальный 15-минутный интервал между использованием препаратов.</P><P>Возможно сочетание глазных капель и мази Флоксал.</P><P>При одновременном применении более одного препарата мазь следует использовать последней.</P>",
            Overdosage =
                        "<P>Не зарегистрировано ни одного случая передозировки.</P><P>В случае местной передозировки необходимо промыть глаз водой.</P>",
            Interaction =
                        "<P>Установлено, что системное применение некоторых фторхинолонов ингибирует метаболический клиренс кофеина и теофиллина.</P><P>Исследования межлекарственного взаимодействия, проведенные с системным офлоксацином, показали, что офлоксацин не оказывает существенного влияния на метаболический клиренс кофеина и теофиллина.</P><P>Несмотря на наличие сообщений о повышенной частоте случаев токсичности для ЦНС при системном применении фторхинолонов при условии одновременного применения вместе с системными НПВП, не было получено ни одного сообщения о подобных случаях при одновременном системном применении НПВП и офлоксацина.</P>",
            Lactation =
                        "<P><I>Беременность</I></P><P>Клинические исследования офлоксацина у беременных женщин не проводились. Было установлено, что системные фторхинолоны вызывают артропатию у неполовозрелых животных. Применение при беременности противопоказано.</P><P><I>Период грудного вскармливания</I></P><P>Есть данные, что офлоксацин и другие фторхинолоны, принимаемые системно, выделяются с грудным молоком, поэтому применение при грудном вскармливании противопоказано.</P>",
            SideEffects =
                        "<P>Серьезные реакции после применения системного офлоксацина наблюдаются редко, и большинство симптомов обратимы. Поскольку после местного применения небольшое количество офлоксацина всасывается системно, возможно возникновение побочных эффектов, которые регистрировались при системном применении.</P><P>Частота возникновения побочных реакций классифицирована в соответствии с рекомендациями ВОЗ: очень часто (&ge;1/10), часто (&ge;1/100 и &lt;1/10), иногда (&ge;1/1000 и &lt;1/100), редко (&ge;1/10000 и &lt;1/1000), очень редко (&lt;1/10000), неизвестно (частоту невозможно оценить по доступным данным).</P><P><I>Со стороны иммунной системы:</I> очень редко - реакция гиперчувствительности (включая ангионевротический отек, одышку, анафилактические реакции, анафилактический шок, отек гортани и отек языка).</P><P><I>Со стороны нервной системы:</I> неизвестно - головокружение.</P><P><I>Со стороны органа зрения:</I> часто - раздражение глаз, дискомфорт в глазах; редко - роговичные преципитаты, особенно при наличии в анамнезе заболеваний роговицы; неизвестно - кератит; конъюнктивит; размытое зрение; светобоязнь; отек глаз; ощущение инородного тела в глазах; усиленное слезотечение; сухость глаз; боль в глазах; глазная гиперемия; гиперчувствительность (в т.ч. зуд глаз и век), периорбитальный отек (включая отек век). Возможны реакции гиперчувствительности, такие как покраснение конъюнктивы и/или легкое жжение в глазу после лечения; однако данные симптомы являются краткосрочными.</P><P><I>Со стороны ЖКТ:</I> неизвестно - тошнота.</P><P><I>Со стороны костно-мышечной системы и соединительной ткани:</I> неизвестно - периорбитальный отек, отек лица, синдром Стивенса-Джонсона, токсический эпидермальный некролиз.</P><P>При системной терапии фторхинолонами сообщалось о воспалениях и разрывах сухожилий, особенно у пожилых пациентов и пациентов, одновременно принимающих ГКС. </P>",
            Indications =
                        "<P>Бактериальные заболевания переднего отрезка глаза, вызванные чувствительными к офлоксацину микроорганизмами:</P><UL><LI>бактериальный конъюнктивит;</LI><LI>кератит;</LI><LI>блефарит;</LI><LI>дакриоцистит;</LI><LI>ячмень;</LI><LI>язва роговицы;</LI><LI>хламидийные инфекции глаз.</LI></UL><P>Профилактика и лечение бактериальной инфекции после травм глаза и хирургических вмешательств (для <B>глазных капель</B>).</P>",
            Contraindications =
                        "<UL><LI>повышенная чувствительность к офлоксацину (или любому другому компоненту, входящему в состав препарата);</LI><LI>беременность;</LI><LI>период грудного вскармливания;</LI><LI>детский возраст до 1 года (эффективность и безопасность не установлены).</LI></UL><P><I>С осторожностью: </I></P><UL><LI>пациентам с повышенной чувствительностью к другим антибактериальным препаратам хинолонового ряда;</LI><LI>пациентам с дефектами эпителия роговицы или язвами роговицы (риск перфорации роговицы);</LI><LI>пациентам с признаками воспаления сухожилий.</LI></UL>",
            SpecialInstructions =
                        "<P>Пациентам с повышенной чувствительностью к другим антибактериальным средствам хинолонового ряда следует применять глазные капли с осторожностью. При возникновении аллергической реакции на офлоксацин, следует прекратить применение препарата.</P><P>При применении офтальмологических препаратов, содержащих офлоксацин, следует учитывать риск ринофарингеального пассажа, который может способствовать возникновению и распространению резистентных штаммов микроорганизмов. Как и в случае с другими антибактериальными средствами, длительное использование может привести к чрезмерному росту нечувствительных организмов.</P><P>Если в течение терапии не наступило улучшение или произошло обострение заболевания, прием препарата нужно прекратить и начать альтернативное лечение</P><P>При лечении пациентов с дефектами эпителия роговицы или язвами роговицы необходимо соблюдать осторожность в связи с риском перфорации роговицы, особенно у пациентов пожилого возраста и с сопутствующими заболеваниями (синдром сухого глаза, ревматоидный артрит), а также при одновременном применении НПВП.</P><P>Воспаление и разрыв сухожилия могут возникать при системной терапии фторхинолонами, включая офлоксацин, особенно у пожилых пациентов и пациентов, одновременно принимающих ГКС. В этих случаях необходимо соблюдать осторожность и прекратить прием препарата при первых признаках воспаления сухожилий.</P><P>Во время терапии офлоксацином следует избегать чрезмерного воздействия солнечного или УФ-излучения (например, солнечные лампы, солярий и т.д.) из-за потенциальной светочувствительности.</P><P>Не рекомендуется во время применения препарата носить контактные линзы.</P><P>Препарат в форме<B> глазных капель </B>содержит консервант бензалкония хлорид, который может вызвать раздражение глаз (особенно у пациентов с сухостью глаз или заболеваниями роговицы), абсорбироваться мягкими контактными линзами, вызывая изменение их цвета и оказывать неблагоприятное воздействие на ткани глаза. Контактные линзы следует вынимать перед применением препарата и при необходимости установить их снова не ранее, чем через 15 минут после инстилляции.</P><P>В случае длительной терапии следует контролировать состояние пациентов из-за возможного раздражения глаз, обусловленного бензалкония хлоридом.</P><P>По имеющимся данным отсутствуют различия побочных эффектов у детей в сравнении со взрослыми пациентами, однако глаза детей более чувствительны к раздражению, что может повлиять на приверженность терапии.</P><P><I>Влияние на способность к управлению транспортными средствами и механизмами</I></P><P>Исследований по влиянию на способность управлять транспортными средствами и работать с механизмами не проводилось.</P><P>При закапывании<B> глазных капель</B> возможна временная нечеткость зрения, поэтому не следует управлять транспортными средствами и механизмами до восстановления четкости зрения.</P><P>При применении <B>глазной мази</B> возможна временная нечеткость зрения, которая длится всего несколько минут, поэтому не следует управлять транспортными средствами и механизмами до восстановления четкости зрения.</P>",
            RenalImpairedUsage = null,
            HepaticImpairedUsage = null,
            ImplementationTerms = "Препарат отпускают по рецепту.",
            ElderlyUsage = null,
            ChildrenUsage = "Противопоказано применение у детей в возрасте до 1 года (эффективность и безопасность не установлены)."
        };

        [TestCase(TestName = "При сравнении различных объектов " +
                             "возвращается false")]
        public void TestEquals_DifferentObjects_ReturnsFalse()
        {
            // Arrange
            var expected = _testInstruction;

            // Act
            var actual = (Instruction)expected.Clone();
            actual.PharmacologicalEffect = "Другой текст"; 
            var isEqual = actual.Equals(expected);

            // Assert
            Assert.That(isEqual, Is.False);
        }

        [TestCase(TestName = "При сравнении объекта с null возвращается " +
                             "false")]
        public void TestEquals_NullObject_ReturnsFalse()
        {
            // Arrange
            var expected = _testInstruction;

            // Act
            var actual = (Instruction)expected.Clone();
            var isEqual = actual.Equals(null);

            // Assert
            Assert.That(isEqual, Is.False);
        }
    }
}
